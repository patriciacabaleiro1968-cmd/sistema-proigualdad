<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Monitoreo - ProIgualdad</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4a3c8d;
            --secondary: #e5438a;
            --accent: #41c4b3;
            --light: #f8f9fa;
            --dark: #343a40;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7f9;
            color: #333;
        }
        
        .navbar {
            background: linear-gradient(135deg, var(--primary), #6a52b3);
        }
        
        .sidebar {
            background-color: white;
            border-right: 1px solid #dee2e6;
            height: calc(100vh - 56px);
            position: sticky;
            top: 56px;
            padding-top: 20px;
            box-shadow: 0 0 15px rgba(0,0,0,0.05);
        }
        
        .sidebar .nav-link {
            color: var(--dark);
            border-left: 4px solid transparent;
            padding: 12px 20px;
            margin: 5px 0;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            background-color: rgba(74, 60, 141, 0.1);
            border-left-color: var(--primary);
            color: var(--primary);
        }
        
        .sidebar .nav-link i {
            margin-right: 10px;
            color: var(--primary);
        }
        
        .card {
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: none;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .progress {
            height: 10px;
            border-radius: 5px;
        }
        
        .kpi-card {
            border-left: 4px solid var(--primary);
        }
        
        .indicator-card {
            border-top: 3px solid var(--secondary);
        }
        
        .activity-card {
            border-top: 3px solid var(--accent);
        }
        
        .btn-primary {
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: #3a2c70;
            border-color: #3a2c70;
        }
        
        .badge-femenino {
            background-color: rgba(229, 67, 138, 0.2);
            color: #c53d74;
        }
        
        .badge-masculino {
            background-color: rgba(65, 196, 179, 0.2);
            color: #2a9c8c;
        }
        
        .dashboard-section {
            display: none;
        }
        
        .dashboard-section.active {
            display: block;
        }
        
        .filter-section {
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .spinner-border {
            width: 3rem;
            height: 3rem;
        }
        
        .data-card {
            border-left: 4px solid var(--accent);
        }
        
        .last-update {
            font-size: 0.8rem;
            color: #6c757d;
        }

        .component-badge {
            background-color: var(--primary);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="text-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando datos...</span>
            </div>
            <p class="mt-3">Cargando datos desde Google Sheets...</p>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-venus-double"></i> Sistema de Monitoreo - ProIgualdad
            </a>
            <div class="d-flex align-items-center">
                <span class="text-light me-3" id="currentDate"></span>
                <button class="btn btn-outline-light btn-sm me-2" onclick="cargarDatos()">
                    <i class="fas fa-sync-alt"></i> Actualizar
                </button>
                <div class="dropdown">
                    <button class="btn btn-outline-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                        <i class="fas fa-download"></i> Exportar Reporte
                    </button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#" onclick="descargarPDF()"><i class="fas fa-file-pdf"></i> PDF</a></li>
                        <li><a class="dropdown-item" href="#" onclick="descargarExcel()"><i class="fas fa-file-excel"></i> Excel</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-2 col-md-3 p-0 sidebar">
                <nav class="nav flex-column">
                    <a class="nav-link active" href="#" data-section="resumen">
                        <i class="fas fa-chart-pie"></i> Resumen General
                    </a>
                    <a class="nav-link" href="#" data-section="indicadores">
                        <i class="fas fa-chart-line"></i> Indicadores
                    </a>
                    <a class="nav-link" href="#" data-section="componentes">
                        <i class="fas fa-puzzle-piece"></i> Componentes
                    </a>
                    <a class="nav-link" href="#" data-section="actividades">
                        <i class="fas fa-tasks"></i> Actividades
                    </a>
                    <a class="nav-link" href="#" data-section="calendario">
                        <i class="fas fa-calendar-alt"></i> Cronograma
                    </a>
                    <a class="nav-link" href="#" data-section="configuracion">
                        <i class="fas fa-cog"></i> Configuración
                    </a>
                </nav>
            </div>

            <!-- Main Content -->
            <div class="col-lg-10 col-md-9 mt-4">
                <!-- Filtros -->
                <div class="filter-section mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-3">
                            <label for="componenteFilter" class="form-label">Componente</label>
                            <select class="form-select" id="componenteFilter">
                                <option value="">Todos los componentes</option>
                                <option value="1">Componente 1: Educación</option>
                                <option value="2">Componente 2: Empresas</option>
                                <option value="3">Componente 3: Medios</option>
                                <option value="4">Componente 4: Gestión</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="estadoFilter" class="form-label">Estado</label>
                            <select class="form-select" id="estadoFilter">
                                <option value="">Todos los estados</option>
                                <option value="no-iniciado">No iniciado</option>
                                <option value="en-progreso">En progreso</option>
                                <option value="completado">Completado</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="mesFilter" class="form-label">Mes</label>
                            <select class="form-select" id="mesFilter">
                                <option value="">Todos los meses</option>
                                <option value="enero">Enero</option>
                                <option value="febrero">Febrero</option>
                                <option value="marzo">Marzo</option>
                                <option value="abril">Abril</option>
                                <option value="mayo">Mayo</option>
                                <option value="junio">Junio</option>
                                <option value="julio">Julio</option>
                                <option value="agosto">Agosto</option>
                                <option value="septiembre">Septiembre</option>
                                <option value="octubre">Octubre</option>
                                <option value="noviembre">Noviembre</option>
                                <option value="diciembre">Diciembre</option>
                            </select>
                        </div>
                        <div class="col-md-3 d-flex align-items-end">
                            <button class="btn btn-primary w-100" onclick="aplicarFiltros()">Aplicar Filtros</button>
                        </div>
                    </div>
                    <div class="mt-2 last-update" id="lastUpdate">
                        Última actualización: --
                    </div>
                </div>

                <!-- Resumen General -->
                <div id="resumen" class="dashboard-section active">
                    <h2 class="mb-4">Resumen del Proyecto ProIgualdad</h2>
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Objetivo General</h5>
                                    <p class="card-text">El aporte de los actores clave en los sectores educación, empresas y medios de comunicación para el fomento de la igualdad de género y los derechos LGBTIA está fortalecido.</p>
                                    <div class="progress mb-3">
                                        <div class="progress-bar bg-success" role="progressbar" id="progresoGeneral" style="width: 35%" aria-valuenow="35" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <small id="textoProgreso">Progreso general: 35%</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card kpi-card">
                                <div class="card-body text-center">
                                    <h6 class="card-subtitle mb-2 text-muted">Metodologías Institucionalizadas</h6>
                                    <h2 class="card-title" style="color: #e5438a;" id="metodologiasInstitucionalizadas">2/5</h2>
                                    <p class="card-text">Meta: 5 metodologías en 3 DDE</p>
                                </div>
                            </div>
                            <div class="card kpi-card mt-3">
                                <div class="card-body text-center">
                                    <h6 class="card-subtitle mb-2 text-muted">Productos Comunicacionales</h6>
                                    <h2 class="card-title" style="color: #41c4b3;" id="productosComunicacionales">10/38</h2>
                                    <p class="card-text" id="avanceProductos">26% de avance</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Distribución por Componente</h5>
                                    <canvas id="componentChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Indicadores Clave</h5>
                                    <canvas id="indicatorChart" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Datos en tiempo real desde Google Sheets -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card data-card">
                                <div class="card-header">
                                    <h5 class="card-title">
                                        <i class="fas fa-database"></i> Datos en Tiempo Real desde Google Sheets
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-striped table-hover" id="tablaDatos">
                                            <thead>
                                                <tr>
                                                    <th>Componente</th>
                                                    <th>Indicador</th>
                                                    <th>Meta</th>
                                                    <th>Actual</th>
                                                    <th>Progreso</th>
                                                    <th>Estado</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><span class="component-badge">C1</span> Educación</td>
                                                    <td>Metodologías educativas institucionalizadas</td>
                                                    <td>5</td>
                                                    <td>2</td>
                                                    <td>
                                                        <div class="progress" style="height: 10px;">
                                                            <div class="progress-bar" role="progressbar" style="width: 40%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100">40%</div>
                                                        </div>
                                                    </td>
                                                    <td><span class="badge bg-warning">En progreso</span></td>
                                                </tr>
                                                <tr>
                                                    <td><span class="component-badge">C1</span> Educación</td>
                                                    <td>Instrumentos de capacitación piloteados</td>
                                                    <td>6</td>
                                                    <td>3</td>
                                                    <td>
                                                        <div class="progress" style="height: 10px;">
                                                            <div class="progress-bar" role="progressbar" style="width: 50%;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">50%</div>
                                                        </div>
                                                    </td>
                                                    <td><span class="badge bg-warning">En progreso</span></td>
                                                </tr>
                                                <tr>
                                                    <td><span class="component-badge">C2</span> Empresas</td>
                                                    <td>Instrumento de sello ampliado</td>
                                                    <td>1</td>
                                                    <td>1</td>
                                                    <td>
                                                        <div class="progress" style="height: 10px;">
                                                            <div class="progress-bar" role="progressbar" style="width: 100%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">100%</div>
                                                        </div>
                                                    </td>
                                                    <td><span class="badge bg-success">Completado</span></td>
                                                </tr>
                                                <tr>
                                                    <td><span class="component-badge">C2</span> Empresas</td>
                                                    <td>Buenas prácticas compartidas</td>
                                                    <td>5</td>
                                                    <td>2</td>
                                                    <td>
                                                        <div class="progress" style="height: 10px;">
                                                            <div class="progress-bar" role="progressbar" style="width: 40%;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100">40%</div>
                                                        </div>
                                                    </td>
                                                    <td><span class="badge bg-warning">En progreso</span></td>
                                                </tr>
                                                <tr>
                                                    <td><span class="component-badge">C3</span> Medios</td>
                                                    <td>Productos mediáticos y comunicacionales</td>
                                                    <td>38</td>
                                                    <td>10</td>
                                                    <td>
                                                        <div class="progress" style="height: 10px;">
                                                            <div class="progress-bar" role="progressbar" style="width: 26%;" aria-valuenow="26" aria-valuemin="0" aria-valuemax="100">26%</div>
                                                        </div>
                                                    </td>
                                                    <td><span class="badge bg-warning">En progreso</span></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Indicadores -->
                <div id="indicadores" class="dashboard-section">
                    <h2 class="mb-4">Indicadores de Desempeño</h2>
                    
                    <!-- Componente 1 -->
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-graduation-cap"></i> Componente 1: Educación
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text"><strong>Objetivo:</strong> Principios de igualdad de género y derechos LGBTIA son aplicados en la práctica docente de docentes con niños/as, adolescentes y madres/padres en las escuelas de educación primaria y secundaria y en los planes curriculares de las escuelas/unidades para la capacitación o formación continua de docentes.</p>
                            
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <div class="card indicator-card">
                                        <div class="card-body">
                                            <h6 class="card-title">Metodologías Educativas Institucionalizadas</h6>
                                            <div class="d-flex justify-content-between mb-2">
                                                <span>Avance</span>
                                                <span id="avanceMetodologias">2/5</span>
                                            </div>
                                            <div class="progress mb-3">
                                                <div class="progress-bar" role="progressbar" style="width: 40%; background-color: #e5438a;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <small>Meta: 5 metodologías en 3 Direcciones Departamentales de Educación</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card indicator-card">
                                        <div class="card-body">
                                            <h6 class="card-title">Instrumentos de Capacitación Piloteados</h6>
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <h4 style="color: #41c4b3;" id="instrumentosPiloteados">3/6</h4>
                                                <span>Instrumentos validados</span>
                                            </div>
                                            <div class="progress">
                                                <div class="progress-bar" role="progressbar" style="width: 50%; background-color: #41c4b3;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <small class="mt-2">50% de progreso hacia la meta</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Componente 2 -->
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-building"></i> Componente 2: Empresas
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text"><strong>Objetivo:</strong> La aplicación de estándares de igualdad de género y derechos LGBTIA en las empresas está fortalecida.</p>
                            
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <div class="card indicator-card">
                                        <div class="card-body">
                                            <h6 class="card-title">Instrumento de Sello Ampliado</h6>
                                            <div class="d-flex justify-content-between mb-2">
                                                <span>Estado</span>
                                                <span class="badge bg-success">Completado</span>
                                            </div>
                                            <div class="progress mb-3">
                                                <div class="progress-bar" role="progressbar" style="width: 100%; background-color: #28a745;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <small>1 instrumento con criterios de igualdad de género y derechos LGBTIA integrados</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card indicator-card">
                                        <div class="card-body">
                                            <h6 class="card-title">Buenas Prácticas Compartidas</h6>
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <h4 style="color: #4a3c8d;" id="buenasPracticas">2/5</h4>
                                                <span>Prácticas documentadas</span>
                                            </div>
                                            <div class="progress">
                                                <div class="progress-bar" role="progressbar" style="width: 40%; background-color: #4a3c8d;" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <small class="mt-2">40% de progreso hacia la meta</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Componente 3 -->
                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-tv"></i> Componente 3: Medios de Comunicación
                            </h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text"><strong>Objetivo:</strong> Las competencias de actores de medios de comunicación de las instituciones públicas para la elaboración de productos mediáticos y comunicacionales para el fomento de la igualdad de género y los derechos LGBTIA están fortalecidas.</p>
                            
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <div class="card indicator-card">
                                        <div class="card-body">
                                            <h6 class="card-title">Productos Comunicacionales</h6>
                                            <div class="d-flex justify-content-between mb-2">
                                                <span>Avance</span>
                                                <span id="avanceProductos">10/38</span>
                                            </div>
                                            <div class="progress mb-3">
                                                <div class="progress-bar" role="progressbar" style="width: 26%; background-color: #17a2b8;" aria-valuenow="26" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <small>Meta: 38 productos mediáticos y comunicacionales</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card indicator-card">
                                        <div class="card-body">
                                            <h6 class="card-title">Productos para Servidores Públicos</h6>
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <h4 style="color: #6f42c1;" id="productosServidores">1/3</h4>
                                                <span>Productos elaborados</span>
                                            </div>
                                            <div class="progress">
                                                <div class="progress-bar" role="progressbar" style="width: 33%; background-color: #6f42c1;" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <small class="mt-2">33% de progreso hacia la meta</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Componentes -->
                <div id="componentes" class="dashboard-section">
                    <h2 class="mb-4">Componentes del Proyecto</h2>
                    
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-primary text-white">
                                    <h5 class="card-title mb-0">Componente 1: Educación</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text"><strong>Objetivo:</strong> Principios de igualdad de género y derechos LGBTIA son aplicados en la práctica docente.</p>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item">5 metodologías educativas institucionalizadas</li>
                                        <li class="list-group-item">6 instrumentos de capacitación piloteados</li>
                                        <li class="list-group-item">Formación a docentes y personal educativo</li>
                                    </ul>
                                </div>
                                <div class="card-footer">
                                    <small class="text-muted">Responsables: ME, GIZ, DDE</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white">
                                    <h5 class="card-title mb-0">Componente 2: Empresas</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text"><strong>Objetivo:</strong> Fortalecer la aplicación de estándares de igualdad de género y derechos LGBTIA en empresas.</p>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item">Instrumento de implementación de sello ampliado</li>
                                        <li class="list-group-item">5 buenas prácticas compartidas</li>
                                        <li class="list-group-item">Plataforma virtual de buenas prácticas</li>
                                    </ul>
                                </div>
                                <div class="card-footer">
                                    <small class="text-muted">Responsables: GIZ, VIO</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-info text-white">
                                    <h5 class="card-title mb-0">Componente 3: Medios de Comunicación</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text"><strong>Objetivo:</strong> Fortalecer competencias para productos mediáticos sobre igualdad de género y derechos LGBTIA.</p>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item">38 productos mediáticos y comunicacionales</li>
                                        <li class="list-group-item">3 productos para servidores públicos</li>
                                        <li class="list-group-item">Metodologías para comunicadores/as</li>
                                    </ul>
                                </div>
                                <div class="card-footer">
                                    <small class="text-muted">Responsables: GIZ, VIO, DWA</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-4">
                            <div class="card h-100">
                                <div class="card-header bg-secondary text-white">
                                    <h5 class="card-title mb-0">Componente 4: Gestión del Proyecto</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text"><strong>Objetivo:</strong> Gestionar y realizar seguimiento a las actividades del proyecto de manera eficiente.</p>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item">Informes de seguimiento y monitoreo</li>
                                        <li class="list-group-item">Estructura de conducción del proyecto</li>
                                        <li class="list-group-item">Coordinación con entidades socias</li>
                                    </ul>
                                </div>
                                <div class="card-footer">
                                    <small class="text-muted">Responsables: Equipo ProIgualdad</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Otras secciones (actividades, cronograma, productos, configuración) -->
                <div id="actividades" class="dashboard-section">
                    <h2 class="mb-4">Actividades</h2>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Esta sección se cargará con datos desde Google Sheets.
                    </div>
                </div>

                <div id="calendario" class="dashboard-section">
                    <h2 class="mb-4">Cronograma</h2>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Esta sección se cargará con datos desde Google Sheets.
                    </div>
                </div>

                <div id="productos" class="dashboard-section">
                    <h2 class="mb-4">Productos</h2>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Esta sección se cargará con datos desde Google Sheets.
                    </div>
                </div>

                <div id="configuracion" class="dashboard-section">
                    <h2 class="mb-4">Configuración</h2>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i> Esta sección permitirá configurar la conexión con Google Sheets.
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Variables globales
        let componentChart, indicatorChart;
        let datosGoogleSheets = {};
        const SHEET_ID = '12BUwefZ4ZTHkNChkZtJlp9aD5dwrpOLPnVecytapt68';
        const API_KEY = 'AIzaSyBgA4lV4Xa0J2sOjW6LJHaG9R6o7QHq_7w';

        // Inicializar la aplicación
        document.addEventListener('DOMContentLoaded', function() {
            // Establecer fecha actual
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Configurar navegación
            configurarNavegacion();
            
            // Inicializar gráficos con datos de ProIgualdad
            inicializarGraficos();
            
            // Cargar datos desde Google Sheets
            cargarDatos();
        });

        // Configurar navegación entre secciones
        function configurarNavegacion() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remover clase active de todos los links
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    // Agregar clase active al link clickeado
                    this.classList.add('active');
                    
                    // Ocultar todas las secciones
                    document.querySelectorAll('.dashboard-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Mostrar la sección correspondiente
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(sectionId).classList.add('active');
                });
            });
        }

        // Inicializar gráficos con datos de ProIgualdad
        function inicializarGraficos() {
            // Gráfico de componentes
            const componentCtx = document.getElementById('componentChart').getContext('2d');
            componentChart = new Chart(componentCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Educación', 'Empresas', 'Medios', 'Gestión'],
                    datasets: [{
                        data: [35, 25, 20, 20],
                        backgroundColor: [
                            '#4a3c8d',  // Educación
                            '#28a745',  // Empresas
                            '#17a2b8',  // Medios
                            '#6c757d'   // Gestión
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Gráfico de indicadores
            const indicatorCtx = document.getElementById('indicatorChart').getContext('2d');
            indicatorChart = new Chart(indicatorCtx, {
                type: 'bar',
                data: {
                    labels: ['Metodologías', 'Instrumentos', 'Sello', 'Buenas Práct', 'Productos'],
                    datasets: [{
                        label: 'Actual',
                        data: [2, 3, 1, 2, 10],
                        backgroundColor: '#4a3c8d',
                        borderWidth: 0
                    }, {
                        label: 'Meta',
                        data: [5, 6, 1, 5, 38],
                        backgroundColor: '#41c4b3',
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cantidad'
                            }
                        }
                    }
                }
            });
        }

        // Cargar datos desde Google Sheets
        async function cargarDatos() {
            mostrarLoading(true);
            
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/DATOS_JERARQUIA?key=${API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error('Error al cargar datos desde Google Sheets');
                }
                
                const data = await response.json();
                
                if (data.values && data.values.length > 1) {
                    procesarDatos(data.values);
                    actualizarInterfaz();
                    document.getElementById('lastUpdate').textContent = 'Última actualización: ' + new Date().toLocaleTimeString();
                } else {
                    console.warn('No se encontraron datos en la hoja de cálculo, usando datos de ejemplo');
                    usarDatosEjemplo();
                }
            } catch (error) {
                console.error('Error al cargar datos desde Google Sheets:', error);
                // Usar datos de ejemplo en caso de error
                usarDatosEjemplo();
            } finally {
                mostrarLoading(false);
            }
        }

        // Procesar datos obtenidos de Google Sheets
        function procesarDatos(datos) {
            // Aquí procesarías los datos según la estructura de tu hoja de cálculo
            // Este es un ejemplo básico, debes adaptarlo a tu estructura real
            
            datosGoogleSheets = {
                // Datos de ejemplo que se reemplazarán con los reales
                metodologias: 2,
                instrumentos: 3,
                sello: 1,
                buenasPracticas: 2,
                productos: 10,
                productosServidores: 1,
                progresoGeneral: 35
            };
            
            // Actualizar tabla de datos
            actualizarTablaDatos(datos);
        }

        // Actualizar tabla con datos de Google Sheets
        function actualizarTablaDatos(datos) {
            // Esta función se encargará de actualizar la tabla con los datos reales
            // Por ahora muestra datos estáticos de ejemplo
            console.log('Datos recibidos de Google Sheets:', datos);
        }

        // Usar datos de ejemplo si no se pueden cargar desde Google Sheets
        function usarDatosEjemplo() {
            datosGoogleSheets = {
                metodologias: 2,
                instrumentos: 3,
                sello: 1,
                buenasPracticas: 2,
                productos: 10,
                productosServidores: 1,
                progresoGeneral: 35
            };
            
            document.getElementById('lastUpdate').textContent = 'Última actualización: Usando datos de ejemplo';
            actualizarInterfaz();
        }

        // Actualizar la interfaz con los datos cargados
        function actualizarInterfaz() {
            // Actualizar KPIs
            document.getElementById('metodologiasInstitucionalizadas').textContent = `${datosGoogleSheets.metodologias}/5`;
            document.getElementById('productosComunicacionales').textContent = `${datosGoogleSheets.productos}/38`;
            document.getElementById('avanceProductos').textContent = `${Math.round((datosGoogleSheets.productos/38)*100)}% de avance`;
            
            // Actualizar barras de progreso
            document.getElementById('progresoGeneral').style.width = `${datosGoogleSheets.progresoGeneral}%`;
            document.getElementById('progresoGeneral').setAttribute('aria-valuenow', datosGoogleSheets.progresoGeneral);
            document.getElementById('textoProgreso').textContent = `Progreso general: ${datosGoogleSheets.progresoGeneral}%`;
            
            // Actualizar sección de indicadores
            document.getElementById('avanceMetodologias').textContent = `${datosGoogleSheets.metodologias}/5`;
            document.getElementById('instrumentosPiloteados').textContent = `${datosGoogleSheets.instrumentos}/6`;
            document.getElementById('buenasPracticas').textContent = `${datosGoogleSheets.buenasPracticas}/5`;
            document.getElementById('avanceProductos').textContent = `${datosGoogleSheets.productos}/38`;
            document.getElementById('productosServidores').textContent = `${datosGoogleSheets.productosServidores}/3`;
            
            // Actualizar gráficos
            actualizarGraficos();
        }

        // Actualizar gráficos con nuevos datos
        function actualizarGraficos() {
            // Actualizar gráfico de componentes
            componentChart.data.datasets[0].data = [
                30 + (datosGoogleSheets.progresoGeneral / 100 * 20),
                20 + (datosGoogleSheets.progresoGeneral / 100 * 15),
                25 + (datosGoogleSheets.progresoGeneral / 100 * 15),
                20 + (datosGoogleSheets.progresoGeneral / 100 * 10)
            ];
            componentChart.update();
            
            // Actualizar gráfico de indicadores
            indicatorChart.data.datasets[0].data = [
                datosGoogleSheets.metodologias,
                datosGoogleSheets.instrumentos,
                datosGoogleSheets.sello,
                datosGoogleSheets.buenasPracticas,
                datosGoogleSheets.productos
            ];
            indicatorChart.update();
        }

        // Mostrar/ocultar overlay de carga
        function mostrarLoading(mostrar) {
            document.getElementById('loadingOverlay').style.display = mostrar ? 'flex' : 'none';
        }

        // Aplicar filtros
        function aplicarFiltros() {
            // Aquí implementarías la lógica de filtrado
            console.log('Aplicando filtros...');
            // Por ahora, solo recargamos los datos
            cargarDatos();
        }

        // Función para descargar PDF
        function descargarPDF() {
            // Crear PDF
            const doc = new jspdf.jsPDF();
            
            // Título
            doc.setFontSize(20);
            doc.text("Reporte de Proyecto ProIgualdad", 105, 15, { align: 'center' });
            doc.setFontSize(12);
            doc.text("Fecha: " + new Date().toLocaleDateString(), 105, 22, { align: 'center' });
            
            // Información del proyecto
            doc.setFontSize(14);
            doc.text("Objetivo General:", 20, 40);
            doc.setFontSize(10);
            const objetivoText = "El aporte de los actores clave en los sectores educación, empresas y medios de comunicación para el fomento de la igualdad de género y los derechos LGBTIA está fortalecido.";
            doc.text(objetivoText, 20, 50, { maxWidth: 170 });
            
            // Avances
            doc.setFontSize(14);
            doc.text("Avances por Componente:", 20, 80);
            doc.setFontSize(10);
            doc.text(`• Educación: ${datosGoogleSheets.metodologias}/5 metodologías institucionalizadas`, 20, 90);
            doc.text(`• Empresas: ${datosGoogleSheets.buenasPracticas}/5 buenas prácticas compartidas`, 20, 100);
            doc.text(`• Medios: ${datosGoogleSheets.productos}/38 productos comunicacionales`, 20, 110);
            
            // Guardar
            doc.save('reporte-proigualdad.pdf');
            
            alert('¡Reporte PDF descargado!');
        }

        // Función para descargar Excel
        function descargarExcel() {
            // Crear hoja de cálculo
            const wb = XLSX.utils.book_new();
            
            // Datos de ProIgualdad
            const datos = [
                ['Indicador', 'Meta', 'Actual', 'Progreso'],
                ['Metodologías educativas institucionalizadas', 5, datosGoogleSheets.metodologias, `${Math.round((datosGoogleSheets.metodologias/5)*100)}%`],
                ['Instrumentos de capacitación piloteados', 6, datosGoogleSheets.instrumentos, `${Math.round((datosGoogleSheets.instrumentos/6)*100)}%`],
                ['Instrumento de sello ampliado', 1, datosGoogleSheets.sello, '100%'],
                ['Buenas prácticas compartidas', 5, datosGoogleSheets.buenasPracticas, `${Math.round((datosGoogleSheets.buenasPracticas/5)*100)}%`],
                ['Productos comunicacionales', 38, datosGoogleSheets.productos, `${Math.round((datosGoogleSheets.productos/38)*100)}%`]
            ];
            
            // Crear hoja
            const ws = XLSX.utils.aoa_to_sheet(datos);
            XLSX.utils.book_append_sheet(wb, ws, "Reporte ProIgualdad");
            
            // Guardar
            XLSX.writeFile(wb, "reporte-proigualdad.xlsx");
            
            alert('¡Reporte Excel descargado!');
        }

        // Función para recargar datos
        function cargarDatos() {
            mostrarLoading(true);
            setTimeout(() => {
                // Simular carga de datos
                usarDatosEjemplo();
                mostrarLoading(false);
                alert('Datos actualizados correctamente');
            }, 1500);
        }
    </script>
</body>
</html>
